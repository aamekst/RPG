IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
GO

BEGIN TRANSACTION;
GO

CREATE TABLE [personagens] (
    [Id] int NOT NULL IDENTITY,
    [Nome] nvarchar(max) NULL,
    [Pontosvida] int NOT NULL,
    [Forca] int NOT NULL,
    [Defesa] int NOT NULL,
    [Inteligencia] int NOT NULL,
    [Classe] int NOT NULL,
    CONSTRAINT [PK_personagens] PRIMARY KEY ([Id])
);
GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Classe', N'Defesa', N'Forca', N'Inteligencia', N'Nome', N'Pontosvida') AND [object_id] = OBJECT_ID(N'[personagens]'))
    SET IDENTITY_INSERT [personagens] ON;
INSERT INTO [personagens] ([Id], [Classe], [Defesa], [Forca], [Inteligencia], [Nome], [Pontosvida])
VALUES (1, 1, 23, 17, 33, N'Nathaniel', 100),
(2, 1, 25, 15, 30, N'Maddy', 100),
(3, 3, 21, 18, 35, N'Cinzeiro', 100),
(4, 2, 18, 18, 37, N'Cass', 100),
(5, 1, 17, 20, 31, N'Rue', 100),
(6, 3, 13, 21, 34, N'Lexi', 100),
(7, 2, 11, 25, 35, N'Fez', 100);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Classe', N'Defesa', N'Forca', N'Inteligencia', N'Nome', N'Pontosvida') AND [object_id] = OBJECT_ID(N'[personagens]'))
    SET IDENTITY_INSERT [personagens] OFF;
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220324222523_InitialCreate', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

ALTER TABLE [personagens] ADD [FotoPersonagem] varbinary(max) NULL;
GO

ALTER TABLE [personagens] ADD [UsuarioId] int NULL;
GO

CREATE TABLE [Armas] (
    [Id] int NOT NULL IDENTITY,
    [Nome] nvarchar(max) NULL,
    [Dano] int NOT NULL,
    CONSTRAINT [PK_Armas] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [usuarios] (
    [Id] int NOT NULL IDENTITY,
    [Username] nvarchar(max) NULL,
    [PasswordHash] varbinary(max) NULL,
    [PasswordSalt] varbinary(max) NULL,
    [Foto] varbinary(max) NULL,
    [Latitude] nvarchar(max) NULL,
    [Longitude] nvarchar(max) NULL,
    [DataAcesso] datetime2 NULL,
    CONSTRAINT [PK_usuarios] PRIMARY KEY ([Id])
);
GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'DataAcesso', N'Foto', N'Latitude', N'Longitude', N'PasswordHash', N'PasswordSalt', N'Username') AND [object_id] = OBJECT_ID(N'[usuarios]'))
    SET IDENTITY_INSERT [usuarios] ON;
INSERT INTO [usuarios] ([Id], [DataAcesso], [Foto], [Latitude], [Longitude], [PasswordHash], [PasswordSalt], [Username])
VALUES (1, NULL, NULL, NULL, NULL, 0xECEEE89D7973BE50D618C08BD0614139085B7989A5FBABDC465DB065651B8E9A9BD0AEB18A2799BB54A121BD09860643549E702F7F7EFA03F2ED48583B217FE3, 0xD11774D934FEF3E4CE9BA56B3CBECEFE16F68992E6197AB756FDAFBE77036512875CDE639E4D15B8BD641B30E33FFCA2A22548EB8CAF734DEDC4E442D453EC4675A4BDA5A26C582D19B7BD4BAED037414246762ABD4CAF84E679EB5ED832DAB651CD3F8219FB9F5EA854CC00C55A64DFCDD920328A3C12DF36C9356F7973B6E8, N'UsuarioAdmin');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'DataAcesso', N'Foto', N'Latitude', N'Longitude', N'PasswordHash', N'PasswordSalt', N'Username') AND [object_id] = OBJECT_ID(N'[usuarios]'))
    SET IDENTITY_INSERT [usuarios] OFF;
GO

CREATE INDEX [IX_personagens_UsuarioId] ON [personagens] ([UsuarioId]);
GO

ALTER TABLE [personagens] ADD CONSTRAINT [FK_personagens_usuarios_UsuarioId] FOREIGN KEY ([UsuarioId]) REFERENCES [usuarios] ([Id]) ON DELETE NO ACTION;
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220408003401_MigracaoUsuario', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

ALTER TABLE [Armas] ADD [PersonagemId] int NOT NULL DEFAULT 0;
GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[Armas]'))
    SET IDENTITY_INSERT [Armas] ON;
INSERT INTO [Armas] ([Id], [Dano], [Nome], [PersonagemId])
VALUES (1, 35, N'Arco e Flecha', 1),
(2, 33, N'Espada', 2),
(3, 31, N'Machado', 3);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[Armas]'))
    SET IDENTITY_INSERT [Armas] OFF;
GO

UPDATE [usuarios] SET [PasswordHash] = 0xC71CB7A5C924EE26B3E772F4F181FDB5452AF4EA52066FE49D2B815CF73549E55CE71D4575922E4B97936FD4649D81599B3F578FCE5B3E13A84A85AC03CABE32, [PasswordSalt] = 0xB6182EBB088DB2FB793A6A37261364AD75C5A056F602CD9A4732739E6B8FB7559C2003A46F4256F8A23D52B4B9034D663D30900339F3835CF3CE610678F40CF2962E0D131F8818694117F9EAE2186DB03174F7D40116AB4F3EC457FFC5FE6D8770FECBD2A8EC0AE7FEFDD8F134A79892E17D8F617380266DC4CB09C8C6873D18
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

CREATE INDEX [IX_Armas_PersonagemId] ON [Armas] ([PersonagemId]);
GO

ALTER TABLE [Armas] ADD CONSTRAINT [FK_Armas_personagens_PersonagemId] FOREIGN KEY ([PersonagemId]) REFERENCES [personagens] ([Id]) ON DELETE CASCADE;
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220408011507_MigracaoUmParaUm', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

CREATE TABLE [Habilidades] (
    [Id] int NOT NULL IDENTITY,
    [Nome] nvarchar(max) NULL,
    [Dano] int NOT NULL,
    CONSTRAINT [PK_Habilidades] PRIMARY KEY ([Id])
);
GO

CREATE TABLE [PersonagemHabilidades] (
    [PersonagemId] int NOT NULL,
    [HabilidadeId] int NOT NULL,
    CONSTRAINT [PK_PersonagemHabilidades] PRIMARY KEY ([PersonagemId], [HabilidadeId]),
    CONSTRAINT [FK_PersonagemHabilidades_Habilidades_HabilidadeId] FOREIGN KEY ([HabilidadeId]) REFERENCES [Habilidades] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_PersonagemHabilidades_personagens_PersonagemId] FOREIGN KEY ([PersonagemId]) REFERENCES [personagens] ([Id]) ON DELETE CASCADE
);
GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome') AND [object_id] = OBJECT_ID(N'[Habilidades]'))
    SET IDENTITY_INSERT [Habilidades] ON;
INSERT INTO [Habilidades] ([Id], [Dano], [Nome])
VALUES (1, 39, N'Adormecer'),
(2, 41, N'Congelar'),
(3, 37, N'Hipnotizar');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Dano', N'Nome') AND [object_id] = OBJECT_ID(N'[Habilidades]'))
    SET IDENTITY_INSERT [Habilidades] OFF;
GO

UPDATE [usuarios] SET [PasswordHash] = 0x88CF22A90FB58B307FF9018DD37226DBFFF6CB202AF1AE64209BE136FDF2832048732FE9765CF39D49FD5701A753C45383403A24C4FA75A3BDBCDCFD7193CA84, [PasswordSalt] = 0x93BD8C8E68BD06229A1612B8D68F324153A4903B8A3194E0382C59146CAFDA11F69E21F837E96AE2BBD4A1B7D7DE65B886CEB04AAE0AEF061F42708BFD526694F7C3D77DEC4889166DA4668CA795E403C008EB671CD8CBA7264AFCAE25A4313A6EBBAAAD4B56D108BEFE9D73B806FE986D54F7FEC57CF2E1940987B9E1F7C18C
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'HabilidadeId', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[PersonagemHabilidades]'))
    SET IDENTITY_INSERT [PersonagemHabilidades] ON;
INSERT INTO [PersonagemHabilidades] ([HabilidadeId], [PersonagemId])
VALUES (1, 1),
(1, 5),
(2, 1),
(2, 2),
(2, 3),
(2, 6),
(3, 3),
(3, 4),
(3, 7);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'HabilidadeId', N'PersonagemId') AND [object_id] = OBJECT_ID(N'[PersonagemHabilidades]'))
    SET IDENTITY_INSERT [PersonagemHabilidades] OFF;
GO

CREATE INDEX [IX_PersonagemHabilidades_HabilidadeId] ON [PersonagemHabilidades] ([HabilidadeId]);
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220408013702_MigracaoMuitosParaMuitos', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

DROP INDEX [IX_Armas_PersonagemId] ON [Armas];
GO

UPDATE [usuarios] SET [PasswordHash] = 0xCCEB1B29C8318CE38483274ED3AC9F2A86C739BE7C1C7F9B2312D1861CC7F2A82DFA568BC3F56D3D8C8DBD42AE17A18841C1E6AEB4C221B36F9C8A859B06FD64, [PasswordSalt] = 0xD37151ECCC4B8510D3FAFB9CFC454F78FC613CB6FE85327F4C2D3BEF34C5594CF1A0CC6B69A1538093893B18D4A17F83CE5B410FC0DB5689753EA2CF76F0DDD358851F7D8FBFBA152FC2257E5D0E75D933452186B264090AA60E492EC33923534534AFC4FEF1B726A44300C83C566B181E1D56474F029DEC7B62793712E56ADD
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

CREATE UNIQUE INDEX [IX_Armas_PersonagemId] ON [Armas] ([PersonagemId]);
GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220428160905_InitialTodosEx', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0xDEE952E93AD755F1DD5FBDD5045331B14DEEFEBA0EAB612EA0B2D2F7638D5AB388FDE3F7158A23763D2D5C7397632487506643B513AE6CD24E13B1F818B2CCC9, [PasswordSalt] = 0x95432CC02A86D17CD23579CB89F854B327DC625147D42B8C365E635EA3F6A8BEDFFA614B37ABA59B9112CE5F5905A5E5F05F835D041CAE8B9D748818FD51DBE83505EA300C8475F97B591DB7B4B2A974E282A6ED93333B2D2957D1216ECE5D6DFF80C14FC0A133333C447A4946676439435792D4550D98968901D879F5CB3C01
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220428223925_InitialTeste', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0x639100D41610C6C3882230582693876312C8D1732BAAFB97E93532BBFD3D00CB67C2AB103021A85637983A6DFC02AC959DC83CAA4CF1A57374E66F4AEC5C5018, [PasswordSalt] = 0xA49035CE3DB5148124FE02E0A63B9C770E6E579D895A9F26CE77A9769D1AE4249922223C1FA522B1E74D909DCE3AA5EA0167194F9981FA35ED2BDEEE1335E1561CB1ADDE27A9B2784B1CD6BD1AE41776682BEAA6556DE2B0CFC9B7DC5ECF6E26870008207636C32811924E938B945D4BEE2331703807567088CBB4FDE518CF33
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220429005424_InitialTEST2', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0x40E15C34E995BD87E3065FD4D50AA0A8BABA61B3CF1B9284491FE7F9146D04EEA7DF4F44DD0C457BAC1F45BEA3CD4AD84BA8BC8DAFDB1B6666365F491EAB9C81, [PasswordSalt] = 0x731D0FCFFDF0975DF4079DB19EDF8F88690EA771C0B43015D0B19E6A48320583FB4CA0C7F5CB3B7271DFB3790D17D71A9A001EE8A11B3EA08983F9FA3000D40DDD48E41EB67D386E07EB493FACC79CF138301C00E97618DF057BA816E3AA49ED9A278D1F389428DB5715B3965E98146027A69437CFCDC14DF37DB73C0CCDB414
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220505225659_teste05.05', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0xD7C6049EC64896A619D691FE1CEF4F2439AE50BA1A3C69CD5CD63EC435B67258C53FB22DB6641E5E0493F3AD71A7123BBDAFD4BA0330D1B1F791099607331283, [PasswordSalt] = 0x1F048406D14F37A90EAF16DA8302648948BD81BC96D3ED8288CD706E4D67BAE3718061669BC93544BBA191614C3C767252F459C7323DA60EEC5F16DD0336CFD577DD8ACAF49BB353B5F0FDEBB87FCF87A07F08A29EE3B0FECBE60938C8944FB8BF42DD0DDA18478ABFFDEE0A9C324F8961E9E8204E3407924BC3C829A42E05A3
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220506012430_perfil', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0xD63765F1A32DD181AFB705673056DB39E5C4651E68B98AD1E65EBF823D5B7A473D9C1048E8ED22922B7D06C3E858BBA1774891F182B7B625D4798F01E1937BFF, [PasswordSalt] = 0x60C4615A10B884057CEDB6BB738C4495147EAEE06D53736FA4D045250A1C4F0E1F5E31106873FFA9B1AC130326691B705B3FF640BEAA86D28780D50615535BAF2C622D9B63BAC18352AE9215B786642EE494FD7755410D6DCC8F053D5F0B8C6C7F02547628603EFB95893FE167C77DE88F9C2414017BD7EA4478A1D581ECF2C6
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220506013406_MigrationsPerfil', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0x94E7AE722D13D7B399FFC9958A2EC00F871AE1844C8485CB5484DC4FF8851FA4575FC9F976D73F6C692D8ECD49E8559E537B71604C99B404832DCDFCFF3B0D60, [PasswordSalt] = 0xDA5551ED384646D0E805DB6F50C0E8699B3A276A09A74161D2A976D0DA3B4218D437A432604250A2E5C0E681AF865F7888A40443AE704677021D52EA2CEE6C2114615B3745D49115027513619572E0473A3876EF9BDE452DA81CABAB2BB745F6CC8E61C7C627111C88C9E7CF408C3286F9E7D5D9BFD41180D646984D2F489B9B
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220512222708_MigracaoPerfil2', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

UPDATE [usuarios] SET [PasswordHash] = 0x77D513BC71B7A7EF21321233DCC3EEA77580DA26BEF8276E5CD09233B94D96F324A0B4E471DFB343F32FCF6CFAFFBB4D8F6AE5934BBB8EF6832E4D93ED1D2179, [PasswordSalt] = 0xE08F17F78456067614257FC90140C91830227C56B286DEC5B9CE4493150E7305F72864CFC6FF740815B35EC62E8420CA2AC2384CD7BF3DE9F3F6FE8F74E148C72A6442FD0529CA16DB52DD58278C28DB758B2FE245C27D2815DFBCA924643613FE2DAE7B02340501EBB482A4D3FE531510D651981EB29084F44E3C8B72EBD23C
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220512225108_MigracaoPerfil3', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

ALTER TABLE [usuarios] ADD [Email] nvarchar(max) NULL;
GO

ALTER TABLE [personagens] ADD [Derrotas] int NOT NULL DEFAULT 0;
GO

ALTER TABLE [personagens] ADD [Disputas] int NOT NULL DEFAULT 0;
GO

ALTER TABLE [personagens] ADD [Vitorias] int NOT NULL DEFAULT 0;
GO

CREATE TABLE [Disputas] (
    [Id] int NOT NULL IDENTITY,
    [DataDisputa] datetime2 NULL,
    [AtacanteId] int NOT NULL,
    [OponenteId] int NOT NULL,
    [Narracao] nvarchar(max) NULL,
    CONSTRAINT [PK_Disputas] PRIMARY KEY ([Id])
);
GO

UPDATE [usuarios] SET [PasswordHash] = 0x0C8D40B6BB4F7E1D31574E848A260D22842674D88D60BF3C744348905BA2A7AF34A5C02183FA6ECACE49F1DD025334D6B783A5B0BC487400135BAC013F5FAB76, [PasswordSalt] = 0x70B2B84B6E850C4CFADA0A90B9523E4650CE9BFA38106635CB98A5A5BE131C81C79F63453FB63A4574C06C0667776DBA81F985918DF91495C1CAD3B25EABF3B2A219952C659EC729B751E1BC0B3E8147EC12A9902EF91B86B0C6601B261D959EB9462A25D358EB9CAEAF8C990457D8B1D7D4ADAE1E9EAD744EDE0520313358F3
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220512230434_MigracaoDisputa', N'5.0.15');
GO

COMMIT;
GO

BEGIN TRANSACTION;
GO

DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[usuarios]') AND [c].[name] = N'Perfil');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [usuarios] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [usuarios] ALTER COLUMN [Perfil] nvarchar(max) NULL;
ALTER TABLE [usuarios] ADD DEFAULT N'Jogador' FOR [Perfil];
GO

UPDATE [usuarios] SET [PasswordHash] = 0xD2FFBE46E9BECF248A2617A9324C25877C1CE6DE8E0DED9682EB83F52AFEF0047D7E9D43C9A9FF28FD6AB99CEE1AEC046E75CD870B2D195EFAC67BC7ECF60DB3, [PasswordSalt] = 0x35DC2EB8B7D031875C1B270B9433A58E2F456F35E1636B79B8BAFA2D37DA1BBD8C7686CAEAAA69066B9D2FC51F4086B1CB82376425FD8958BB02EFD1474D27967C03CC4FF496F1AB1A18DF92E43F4CA2FE4DCB812135649E7C063CDE6D0DE212568BB218C9705B0AA4FD8F6C02996C46699F90C2B5A3234832F7F371FF6D6C58
WHERE [Id] = 1;
SELECT @@ROWCOUNT;

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20220512235234_MigracaoFinal1205', N'5.0.15');
GO

COMMIT;
GO

